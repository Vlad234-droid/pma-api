<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tesco.pma.cms.dao.ContentDAO">

    <resultMap id="contentStruct" type="com.tesco.pma.cms.model.Content">
        <id column="id" property="id"/>
        <result column="key" property="key"/>
        <result column="title" property="title"/>
        <result column="description" property="description"/>
        <result column="image_link" property="imageLink"/>
        <result column="created_by" property="createdBy"/>
        <result column="created_time" property="createdTime"/>
        <result column="version" property="version"/>

        <result property="status" column="status_id" typeHandler="com.tesco.pma.dao.utils.DictionaryItemTypeHandler"
                javaType="com.tesco.pma.cms.model.ContentStatus"/>
    </resultMap>

    <select id="findByKey" resultMap="contentStruct">
        SELECT * FROM cms_content cc WHERE cc.key = #{key}
    </select>

    <insert id="create" flushCache="true" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        INSERT INTO cms_content (id, key, title, description, image_link, created_by, created_time, version, status_id)
        VALUES (#{content.id}, #{content.key}, #{content.title}, #{content.description},
            #{content.imageLink}, #{content.createdBy}, #{content.createdTime}, #{content.version},
            #{content.status, typeHandler=com.tesco.pma.dao.utils.DictionaryItemTypeHandler,
                javaType=com.tesco.pma.cms.model.ContentStatus})
    </insert>

    <delete id="delete">
        DELETE FROM cms_content WHERE id = #{id}
    </delete>

<!--    <update id="update" flushCache="true">-->
<!--        UPDATE note_folders-->
<!--        SET title = (#{folder.title}), owner_uuid = (#{folder.ownerColleagueUuid}), parent_uuid = (#{folder.parentFolderUuid})-->
<!--        WHERE id = #{folder.id}-->
<!--    </update>-->



</mapper>